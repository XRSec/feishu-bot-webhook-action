name: Example Workflow

on:
  push:
    branches: [ main ]
  pull_request:
    types: [ opened, synchronize, closed ]
  workflow_dispatch:
    inputs:
      custom_message:
        description: '这是一个按钮'
        required: false
        default: ''

env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  notify:
    runs-on: ubuntu-latest
    if: github.event_name == 'workflow_dispatch'
    steps:
      - uses: actions/checkout@v4
      - name: Send notification to Feishu
        uses: ./
        with:
          FEISHU_BOT_WEBHOOK: ${{ secrets.FEISHU_BOT_WEBHOOK }}
          FEISHU_BOT_SIGNKEY: ${{ secrets.FEISHU_BOT_SIGNKEY }}
          MSG_TEXT: |
            notation字号
            standard emoji 😁😢🌞💼🏆❌✅
            *italic*
            **bold**
            ~~strikethrough~~
            [differentiated redirection]($urlVal)
            <at id=all></at>"
            // Content written using markdown syntax
                        

  notify-on-push:
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    steps:
      - uses: actions/checkout@v4
      - name: Send push notification to Feishu
        uses: ./
        with:
          FEISHU_BOT_WEBHOOK: ${{ secrets.FEISHU_BOT_WEBHOOK }}
          FEISHU_BOT_SIGNKEY: ${{ secrets.FEISHU_BOT_SIGNKEY }}
          # 不设置 MSG_TEXT, 将发送模板消息
  del_runs:
    runs-on: ubuntu-latest
    steps:
      - name: Delete workflow runs
        uses: Mattraks/delete-workflow-runs@main
        with:
          token: ${{ env.GITHUB_TOKEN }}
          repository: ${{ github.repository }}
          retain_days: ${{ github.event.inputs.days }}
          keep_minimum_runs: 3
